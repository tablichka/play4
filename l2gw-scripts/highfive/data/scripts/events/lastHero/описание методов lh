Описание работы методов:
onLoad()
Загружает скрипт при старте сервера. Если событие включено в конфигурации, планирует запуск события по расписанию.
onReload()
Вызывается при перезагрузке скрипта. В данном случае не выполняет никаких действий.
onShutdown()
Вызывается при выключении сервера. В данном случае не выполняет никаких действий.
isRunned()
Возвращает статус события (запущено или нет).
DialogAppend_31225(Integer val)
Возвращает HTML-контент для диалога с NPC (ID 31225), используемый для взаимодействия игрока с событием.
start()
Запускает событие Last Hero, если вызвано администратором или по расписанию. Устанавливает статус регистрации, очищает списки участников и запускает задачи для анонсов и регистрации.
question()
Отправляет всем подходящим игрокам предложение участвовать в событии через скриптовый запрос.
isRegistered(L2Player player)
Проверяет, зарегистрирован ли игрок на событие.
addPlayer()
Регистрирует игрока на событие, проверяя условия участия и текущий статус события.
announce()
Анонсирует оставшееся время до начала события. Если участников недостаточно, отменяет событие. Если время истекло, запускает подготовку.
prepare()
Подготавливает событие: телепортирует игроков в колизей, отправляет правила и запускает таймер до начала боя.
teleportPlayersToColiseum()
Телепортирует зарегистрированных игроков в колизей, создает инстанс события, применяет баффы и снимает эффекты, если требуется.
go()
Начинает бой, разблокируя игроков, отправляя сообщение о начале и запуская таймер завершения боя.
getParticipants()
Возвращает список игроков, находящихся в инстансе события и участвующих в нем.
endBattle()
Завершает бой без победителя, анонсирует завершение и возвращает игроков на исходные позиции.
end()
Завершает событие, восстанавливает состояние игроков (HP, MP, CP), снимает эффекты, возвращает их на исходные позиции и завершает инстанс.
onDie(L2Character killed, L2Character killer)
Обрабатывает смерть игрока в бою, выдавая награды убийце (в зависимости от режима) и проверяя, остался ли один живой игрок для определения победителя.
endByWinner(L2Player lastHero)
Завершает событие с победителем, выдавая ему награду и статус героя, анонсируя победу и возвращая всех игроков.
getLastHero()
Находит последнего живого игрока в зоне события для определения победителя.
rescheduleEvent()
Планирует следующий запуск события по расписанию, если оно включено в конфигурации.
OnPlayerExit(L2Player player)
Обрабатывает выход игрока из игры, удаляя его из списка зарегистрированных или участников и проверяя условия завершения события.
ZoneListener (внутренний класс)
objectEntered(L2Zone zone, L2Character object): Ничего не делает при входе в зону.
objectLeaved(L2Zone zone, L2Character object): Обрабатывает выход игрока из зоны события, удаляя его из участников и проверяя условия завершения события.
sendZoneStatus(L2Zone zone, L2Player object): Ничего не делает при запросе статуса зоны.